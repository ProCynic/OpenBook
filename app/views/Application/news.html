
#{extends 'two_panel.html' /}
<div class="grid_9">
  <div id="contentArea">
    <div class="pagelet">
      <a href="#">Update Status</a>
      <a href="#">Add Photo / Video</a>
      <a href="#">Ask Question</a>

	 #{if user.id == currentUser.id}
      #{/if}
      #{else}
        <a href="@{Posts.poke(user.id)}">Poke!</a>
      #{/else}

      #{if user.id == currentUser.id}
        <a id="about-button" href="@{Application.edit_basic}">About me</a>
      #{/if}
      #{else}
        <a id="about-button" href="@{Application.about(user.id)}">About ${user.first_name}</a>
      #{/else}
    </div>
    <br />
    #{if user.checkFriendship(user.id) == 'Request Friendship'}
      <a id="friend-button" href="@{Application.requestFriends(user.id)}">
        ${user.checkFriendship(user.id)}
      </a>
    #{/if}
    #{elseif user.checkFriendship(user.id) == 'Friendship Requested'}
      Friendship Requested
    #{/elseif}
    #{elseif user.checkFriendship(user.id) == 'Friends'}
      Friends :) 
      <a id="friend-button" href="@{Application.removeFriends(user.id)}">
        Remove friend
      </a>
    #{/elseif}

    #{if user.id == currentUser.id}
      <textarea name="post_content" id="postContent" style="resize: none;color:grey;" rows="2" cols="45" maxlength="400" onclick="document.post_form.post_content.value='';">Write something...</textarea>     
      <input type="submit" value="Post" id="postSubmit" />
    #{/if}
    
    <div id="postsList">
    #{list items:user.news(), as:'item'} 
      #{post currentUser:currentUser,user:user,item:item /}
    #{/list}
    </div>
  </div>
</div> <!-- grid_9 -->

<div class="grid_3">
  more newsfeed on the side<br />
  birthdays<br />
  create events<br />
</div><!-- grid_4 -->

<script type="text/javascript">
   $('input#postSubmit').click(function(event) {
     var postData = {
         postContent : $("textarea#postContent").val(),
     };
     $.post("/posts/makeNewPost", postData, function(data) {
       var new_item = $(data).hide();
       $("div#postsList").prepend(new_item);
       new_item.slideDown();
       $("textarea#postContent").val('');
     });
   });
</script>

<script>
  $('textarea#postContent').autoResize({
  maxHeight: 150,
  minHeight: 50,
  extraSpace: 30
  });
  $('textarea#commentContent').autoResize({
  maxHeight: 70,
  minHeight: 20,
  extraSpace: 20
  });
</script>

<script>
    $('#postContent')
    .focusin(function() {
        if ( this.value == 'Write something...' ) {
            this.value = '';    
        }
    })
    .focusout(function() {
        if ( this.value == '' ) {
            this.value = 'Write something...';    
        }
});
</script>


