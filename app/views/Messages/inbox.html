#{extends 'two_panel.html' /}
<link rel="stylesheet" type="text/css" media="screen"
      href="@{'/public/stylesheets/messages.css'}" />

<div id="contentArea-BigPage">
  <div class="row">
    <h1 class="span2">Inbox</h1>
    <a class="btn btn-primary span2" href="#create-message" data-toggle="modal" ><i class="icon-plus"></i> Create Message</a>
  </div>
  <div class="row">
    <div id="msg-sent-alert" class="alert alert-success span4 hide vertical-element msg-alert" style="text-align:center;">
      <strong>Message Sent</strong>
    </div>
    <div class="span8"></div>
    <div id="msg-failed-alert" class="alert alert-error span4 hide vertical-element msg-alert" style="text-align:center;">
      <strong>Message Not Sent</strong>
    </div>
    <div class="span8"></div>
  </div>
  <hr />

<!--
  #{if user.checkFriendship(user.id) == 'Request Friendship'}
    <a id="friend-button" href="@{Application.requestFriends(user.id)}">
      ${user.checkFriendship(user.id)}
    </a>
  #{/if}
  #{elseif user.checkFriendship(user.id) == 'Friendship Requested'}
    Friendship Requested
  #{/elseif}
  #{elseif user.checkFriendship(user.id) == 'Friends'}
    Friends :) <a id="friend-button"
                  href="@{Application.removeFriends(user.id)}"> Remove friend </a>
  #{/elseif}
  <br>
-->
  
  <h2>Messages</h2>
  <ul class="unstyled" id="message-list">
    #{list items:user.inbox(), as:'item'}
      <li>
        #{message msg:item /}
      </li>
    #{/list}
  </ul>
</div>

<div class="modal hide fade" id="create-message" style="display: none;">
  <div class="modal-header">
    <a class="close" data-dismiss="modal"><i class="icon-remove"></i></a>
    <h3>Create A Message</h3>
  </div>
  <form id="new-message">
    <div class="modal-body">
      <label>To </label>
      <input type="text" id="message-recipient" placeholder="TODO: typeahead" />
      <label>Title </label>
      <input type="text" id="message-title" />
      <label>Your Message </label>
      <textarea id="message-content"></textarea>
    </div>
    <div class="modal-footer">
      <div class="pull-left">
        <button class="btn btn-success" data-dismiss="modal" onclick="submitMessage()">Send Message</button>
        <button class="btn btn-danger" data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </form>
</div>

<script src="/public/javascripts/messages.js"></script>
<!--
<script>
  $('#create-message').on('show', $('.msg-alert').hide());
</script>
-->
